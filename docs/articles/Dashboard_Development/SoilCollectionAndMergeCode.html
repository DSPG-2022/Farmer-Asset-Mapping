<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Retreiving and Connecting Soil Data to the Dashboard • DSPGFarmer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Retreiving and Connecting Soil Data to the Dashboard">
<meta property="og:description" content="DSPGFarmer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">DSPGFarmer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dashboard
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/BeginningFarmerDashboard.html">Beginning Farmer Asset Mapping</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Dashboard Development
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/Dashboard_Development/SoilCollectionAndMergeCode.html">Retreiving and Connecting Soil Data to the Dashboard</a>
    </li>
    <li>
      <a href="../../articles/Dashboard_Development/SpecialtyCropAndGddCode.html">Developing Specialty Crop Data and Calculating GDDs</a>
    </li>
    <li>
      <a href="../../articles/Dashboard_Development/WeatherAndRiskManagementCode.html">Exploring Weather and Climate Data, Scraping, and Connecting to the Dashboard</a>
    </li>
    <li>
      <a href="../../articles/Dashboard_Development/UserInterfaceCode.html">Creating the Interactive User Input for Automating the Dashboard</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DSPG2021/Farmer-Asset-Mapping/" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Retreiving and Connecting Soil Data to the
Dashboard</h1>
            
      
      
      <div class="hidden name"><code>SoilCollectionAndMergeCode.Rmd</code></div>

    </div>

    
    
<p>The libraries Used To Gather, Clean and Merge Soil Data</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#library(DSPGFarmer)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/FedData" class="external-link">FedData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ggrothendieck/sqldf" class="external-link">sqldf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span></code></pre></div>
<p>Gathering Inputs from PHP</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="st">"C:\\Users\\cornd\\OneDrive\\Documents\\GitHub\\Farmer-Asset-Mapping\\Data Exploration\\TestPHP"</span><span class="op">)</span></span>
<span><span class="va">args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/commandArgs.html" class="external-link">commandArgs</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##Bounding Box Input</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">2</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##INPUTS from php</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">ymin</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">ymax</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmin</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/xmin.html" class="external-link">xmax</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">lon</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">args</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="gather-data-from-web-soil-survey-ssurgo-data">Gather Data from Web Soil Survey (SSURGO Data)<a class="anchor" aria-label="anchor" href="#gather-data-from-web-soil-survey-ssurgo-data"></a>
</h2>
<div class="section level4">
<h4 id="input">Input:<a class="anchor" aria-label="anchor" href="#input"></a>
</h4>
<p>can Either be a Rasterlayer or a Spatial object</p>
<p>For this, we are using a Rasterlayer that uses the coordinates
selected from the user as the bounding box</p>
</div>
<div class="section level4">
<h4 id="output">Output:<a class="anchor" aria-label="anchor" href="#output"></a>
</h4>
<p>It downloads 2 Folders to local File, a <strong>RAW</strong> and an
<strong>EXTRACTIONS</strong> folder</p>
<p>Raw is raw zipped data, EXTRACTIONS holds info being used, has both
tabular (.csv) and spatial object (.shp)</p>
<p>In Extraction, will have folder named as label parameter</p>
</div>
<div class="section level4">
<h4 id="force-redo">force.redo:<a class="anchor" aria-label="anchor" href="#force-redo"></a>
</h4>
<p>Parameter in function that if</p>
<p>set to false, means that if there is already data in label folder,
then it won’t download data from web soil survey</p>
<p>set to true, any time it is called it will download data from web
soil survey and overwrite what is stored in label folder</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Area</span><span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/FedData/reference/get_ssurgo.html" class="external-link">get_ssurgo</a></span><span class="op">(</span>template <span class="op">=</span> <span class="va">s</span>,label <span class="op">=</span> <span class="st">"CropSelection_V3"</span>, force.redo <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="cleaning-and-merging-ssurgo-data">Cleaning and Merging SSURGO Data<a class="anchor" aria-label="anchor" href="#cleaning-and-merging-ssurgo-data"></a>
</h2>
<p>The SSURGO data has both spatical and tabular data, but for cleaning
we only want to look at the tabluar</p>
<p>Will Merge it to the spatial file in tableau</p>
<p><a href="https://www.nrcs.usda.gov/wps/portal/nrcs/detail/soils/survey/?cid=nrcs142p2_053627" class="external-link">More
Information About SSURGO data structure</a></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Data</span> <span class="op">&lt;-</span> <span class="va">Area</span><span class="op">$</span><span class="va">tabular</span></span>
<span></span>
<span><span class="co">##Tables of data we are using</span></span>
<span><span class="va">componet</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">component</span></span>
<span><span class="va">muaggart</span> <span class="op">&lt;-</span><span class="va">Data</span><span class="op">$</span><span class="va">muaggatt</span></span>
<span><span class="va">mapunit</span> <span class="op">&lt;-</span><span class="va">Data</span><span class="op">$</span><span class="va">mapunit</span></span>
<span><span class="va">comonth</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">comonth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">month</span><span class="op">==</span><span class="st">"May"</span><span class="op">)</span> <span class="co">##only want month of may to follow CSR2</span></span>
<span><span class="va">coerosionacc</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">coerosionacc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rvindicator</span><span class="op">==</span><span class="st">"Yes"</span><span class="op">)</span> <span class="co">##only care about dominant areas</span></span>
<span><span class="va">chorizon</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">chorizon</span></span>
<span><span class="va">chtexturegrp</span> <span class="op">&lt;-</span><span class="va">Data</span><span class="op">$</span><span class="va">chtexturegrp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rvindicator</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span> <span class="co">##only care about dominant areas</span></span></code></pre></div>
<p>Merging The map units data and components together</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Overall</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">muaggart</span>,<span class="va">componet</span>,by <span class="op">=</span> <span class="st">"mukey"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Overall</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Overall</span>,<span class="va">mapunit</span>,by <span class="op">=</span> <span class="st">"mukey"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Overall</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Overall</span>,<span class="va">comonth</span>,by <span class="op">=</span> <span class="st">"cokey"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Overall</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Overall</span>,<span class="va">coerosionacc</span>,by <span class="op">=</span> <span class="st">"cokey"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chorizon2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">chorizon</span>,<span class="va">chtexturegrp</span>, by <span class="op">=</span> <span class="st">"chkey"</span>, all.x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">chorizon2</span> <span class="op">&lt;-</span><span class="va">chorizon2</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>depth <span class="op">=</span> <span class="va">hzdept.r</span> <span class="op">/</span><span class="fl">2.54</span><span class="op">)</span> <span class="co">##convert cm to inches</span></span></code></pre></div>
<p>Some Data of SSURGO comes in at varying depth levels, like pH or
Available Water Storage</p>
<p>Because Crops have a specific max rooting depth, we only want to look
at the values of data that are in the rooting depths range (0 - Max
Rooting Depth)</p>
<p>CropData is our Database of specialty crops that includes the rooting
depth</p>
<p>sqldf (which uses SQL) is used because we are merging based on an
<strong>inequality</strong> and it makes it easier to do than in R</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CropData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="st">"Input\\Crop-Info_Farmer Asset Mapping.xlsx"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">##Merge Soil Data With Crop Data, gets rid of all values that are past the max Rooting Depth (Later going to average depths)</span></span>
<span><span class="va">MergedData</span> <span class="op">&lt;-</span> <span class="fu">sqldf</span><span class="op">(</span><span class="st">"select * from chorizon2 left join CropData</span></span>
<span><span class="st">             on (chorizon2.depth &lt;= CropData.Depth_l)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##Filters for areas without crops</span></span>
<span><span class="va">MergedDataNoNA</span> <span class="op">&lt;-</span> <span class="va">MergedData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">`Types of Crops`</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now that we are looking at the right depths, we find what value to
use</p>
<p>For quantitative values like pH and AWS:</p>
<pre><code>We use the average based on all depths in range</code></pre>
<p>For qualitative values like soil texture:</p>
<pre><code>We follow how the query tool on the Web soil survey does and use the surface layer data</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chorzonSim</span> <span class="op">&lt;-</span><span class="va">MergedDataNoNA</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>depthLevel <span class="op">=</span> <span class="st">"0-MaxRootDepth"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##for values that very on depth, chose to take average of or value on surface layer</span></span>
<span><span class="va">chorzonSim2</span><span class="op">&lt;-</span> <span class="va">chorzonSim</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">depthLevel</span><span class="op">==</span><span class="st">"0-MaxRootDepth"</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cokey</span>,<span class="va">`Types of Crops`</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>soilText<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">depth</span><span class="op">==</span><span class="fl">0</span>,<span class="va">texdesc</span>,<span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>ksat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ksat.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,awc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">awc.r</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,caco3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">caco3.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,gypsum<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">gypsum.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,sar <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sar.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,ec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ec.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,cec7<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cec7.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, ph <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ph1to1h2o.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,ph_l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ph1to1h2o.l</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,ph_h<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ph1to1h2o.h</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,om<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">om.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            ptotal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ptotal.r</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,soilTextsum <span class="op">=</span> <span class="va">soilText</span>,Kfact <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">kffact</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">soilTextsum</span><span class="op">!=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>Now that data is averaged, merge data with crop data</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Now that data is averaged, remerge data with crop data</span></span>
<span><span class="va">chData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">chorzonSim2</span>,<span class="va">CropData</span>,by <span class="op">=</span> <span class="st">"Types of Crops"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Overall2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Overall</span>,<span class="va">chData</span>,by <span class="op">=</span> <span class="st">"cokey"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Overall2</span> <span class="op">&lt;-</span> <span class="va">Overall2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">majcompflag</span><span class="op">==</span><span class="st">"Yes"</span><span class="op">)</span> <span class="co">##Use the componets that are the majorty of the mapunit</span></span></code></pre></div>
<p>Now that everything is all together, we select only the values that
we want to use</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">Overall2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">musym.x</span>,<span class="va">mukey</span>,<span class="va">cokey</span>,muname <span class="op">=</span> <span class="va">muname.x</span>,<span class="va">taxorder</span>,<span class="va">compname</span>,<span class="va">slope.r</span>,<span class="va">slopegradwta</span>, <span class="va">slope.l</span>,<span class="va">slope.h</span>,<span class="va">localphase</span>,<span class="va">erokind</span>,<span class="va">erocl</span>,<span class="va">tfact</span>,<span class="va">Kfact</span>,<span class="va">wei</span>,</span>
<span>         <span class="va">niccdcd</span>,<span class="va">hydgrp</span>,<span class="va">soilslippot</span>,<span class="va">drainagecl</span>,<span class="va">drclassdcd</span>,<span class="va">niccdcd</span>,<span class="va">awc</span>,<span class="va">aws025wta</span>,<span class="va">aws0150wta</span>, <span class="va">flodfreqcl</span>,<span class="va">floddurcl</span>,<span class="va">pondfreqcl</span>,</span>
<span>         <span class="va">ponddurcl</span>,<span class="va">flodfreqdcd</span>,<span class="va">flodfreqmax</span>,<span class="va">pondfreqprs</span>,<span class="va">iacornsr</span>,<span class="va">ph</span>,<span class="va">ph_l</span>,<span class="va">ph_h</span>,<span class="va">cec7</span>,<span class="va">gypsum</span>,<span class="va">ksat</span>,<span class="va">ec</span>,<span class="va">sar</span>,<span class="va">caco3</span>,<span class="va">om</span>,<span class="va">ptotal</span>,</span>
<span>         soilTextdes <span class="op">=</span><span class="va">soilTextsum</span>,<span class="va">`Types of Crops`</span>,<span class="va">`Soil Types`</span>,<span class="va">`Rooting Depth`</span>,<span class="va">`pH-Level`</span>,<span class="va">`Temperature Tolerances`</span>,<span class="va">ph_L</span>,<span class="va">ph_H</span>,<span class="va">Boron</span>,<span class="va">Copper</span>,<span class="va">Zinc</span>,<span class="va">Molybdenum</span>,<span class="va">Iron</span>,<span class="va">Manganese</span>,<span class="va">`Soil Boron`</span>,<span class="va">`Soil Magnesium`</span>,<span class="va">`Storage Life`</span>,<span class="va">`Crop Maturity Late Variety`</span>,<span class="va">`Crop Maturity Early Variety (days)`</span>,<span class="va">`Storage Humidity (%)`</span>,<span class="va">`Storage Temp (  ̊F)`</span>,<span class="va">`Base Temp in F`</span>,<span class="va">Nitrogen</span><span class="op">)</span></span></code></pre></div>
<p>In order for our crop rotation dashboard to be linked with our crop
data, we will merge it together here</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Simple</span>,<span class="va">CropRotation</span>, by.x <span class="op">=</span> <span class="st">"Types of Crops"</span>, by.y <span class="op">=</span> <span class="st">"Crop"</span>, all.x<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="adding-flags">Adding Flags<a class="anchor" aria-label="anchor" href="#adding-flags"></a>
</h3>
<p>This section of code is going to be how we determine flags</p>
<p>Based on the corn sutability rating and the information we gleamed
from research, we have a list of 10 variables that deal with soil and
are important to crop growth</p>
<p>We will determine how many issues there are for all map units in the
selected area for <strong>each</strong> crop</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Simple</span><span class="op">&lt;-</span> <span class="va">Simple</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ph</span> <span class="op">&lt;=</span> <span class="va">ph_H</span> <span class="op">&amp;</span> <span class="va">ph</span><span class="op">&gt;=</span><span class="va">ph_L</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,FlagDesc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">ph</span> <span class="op">&lt;=</span> <span class="va">ph_H</span> <span class="op">&amp;</span> <span class="va">ph</span><span class="op">&gt;=</span><span class="va">ph_L</span>,<span class="st">""</span>,<span class="st">",PH does not fit into range"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">soilTextdes</span> <span class="op">!=</span> <span class="va">`Soil Types`</span>,<span class="va">Flags</span><span class="op">+</span><span class="fl">1</span>,<span class="va">Flags</span><span class="op">)</span>,FlagDesc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">soilTextdes</span><span class="op">!=</span><span class="va">`Soil Types`</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="st">"soil texture does not match"</span>,sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tfact</span> <span class="op">&lt;</span><span class="fl">4</span>,<span class="va">Flags</span><span class="op">+</span><span class="fl">1</span>,<span class="va">Flags</span><span class="op">)</span>,FlagDesc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tfact</span> <span class="op">&lt;</span><span class="fl">4</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="st">"this soil's erosion tolerance may be an issue"</span>,sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span> <span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags  <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Kfact</span><span class="op">&gt;</span> <span class="fl">.38</span>,<span class="va">Flags</span><span class="op">+</span><span class="fl">1</span>,<span class="va">Flags</span><span class="op">)</span>,FlagDesc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Kfact</span><span class="op">&gt;</span> <span class="fl">.38</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="st">"this soil is more susceptible to erosion"</span>,sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags  <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">om</span><span class="op">&lt;</span><span class="fl">2</span> <span class="op">|</span> <span class="va">om</span><span class="op">&gt;</span><span class="fl">8</span>,<span class="va">Flags</span><span class="op">+</span><span class="fl">1</span>,<span class="va">Flags</span><span class="op">)</span>,FlagDesc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">om</span><span class="op">&lt;</span> <span class="fl">2</span><span class="op">|</span><span class="va">om</span><span class="op">&gt;</span><span class="fl">8</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="st">"this soil's organic matter percent could be an issue"</span>,sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags  <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">erocl</span> <span class="op">==</span> <span class="st">"Class 2"</span>,<span class="va">Flags</span><span class="op">+</span><span class="fl">1</span>,<span class="va">Flags</span><span class="op">)</span>,FlagDesc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">erocl</span> <span class="op">==</span> <span class="st">"Class 2"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="st">"this soil's topsoil may have been depleated"</span>,sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags  <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">aws0150wta</span> <span class="op">&lt;=</span><span class="fl">9.00</span>,<span class="va">Flags</span><span class="op">+</span><span class="fl">1</span>,<span class="va">Flags</span><span class="op">)</span>,FlagDesc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">aws0150wta</span><span class="op">&lt;=</span><span class="fl">9.00</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="st">"this soil's water holding may be limited"</span>,sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Flags  <span class="op">=</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">drclassdcd</span> <span class="op">==</span><span class="st">"Very poorly drained"</span> <span class="op">|</span> <span class="va">drclassdcd</span> <span class="op">==</span> <span class="st">"Poorly drained"</span>,<span class="va">Flags</span><span class="op">+</span><span class="fl">1</span>,<span class="va">Flags</span><span class="op">)</span>,FlagDesc <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">drclassdcd</span> <span class="op">==</span><span class="st">"Very poorly drained"</span> <span class="op">|</span> <span class="va">drclassdcd</span> <span class="op">==</span> <span class="st">"Poorly drained"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="st">"this soil's drainage may be limited"</span>,sep<span class="op">=</span><span class="st">', '</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>FlagDesc <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">==</span><span class="st">','</span>,<span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">FlagDesc</span>,<span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span>,<span class="va">FlagDesc</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To save having to output the fips code and state abbreviation back
into php and run this script, we just run it from this R script</p>
<p>This Code takes in the lat and lon of the user, along with the County
FIPS code and State ID to update the links we provide so that when users
select the links, it shows to the location they selected</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##State Fips and State Abv (IA)</span></span>
<span><span class="co">##Used In Updates Risk URL PARAMETERS</span></span>
<span><span class="va">Statefips</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fl">19000</span>,<span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">legend</span><span class="op">$</span><span class="va">areasymbol</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">StateAbv</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">legend</span><span class="op">$</span><span class="va">areasymbol</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"Cory_UpdateRiskURLParams.R"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we save our data to a csv</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">Simple</span>,<span class="st">"Output\\CropSelection2.csv"</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
